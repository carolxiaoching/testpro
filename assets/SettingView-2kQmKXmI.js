import{e as T,M as B,m as E,f as c,s as A,E as h,k as f,n as s,z as y,t as i,S as V,p as l,w as k,i as _,ag as z,ah as j,l as g,A as F,q as w}from"./index-C3wRXjM7.js";import{_ as D}from"./UploadComponent-ddyiUDW-.js";const G={class:"row py-17"},H={class:"col-12 col-xl-3"},J={class:"sidebarList"},K={class:"col-12 col-xl-7"},O={key:0,class:"px-16 px-md-18 py-16 mx-auto bg-white shadow-sm rounded"},Q={class:"mb-8"},W=["value"],X={class:"mb-8"},Y=["value"],Z={class:"mb-8"},ee={class:"mb-8"},se={class:"mb-16"},le={class:"text-center"},ae=["disabled"],te={key:1,class:"px-16 px-md-18 py-16 mx-auto bg-white shadow-sm rounded"},oe={key:2,class:"px-16 px-md-18 py-16 mx-auto bg-white shadow-sm rounded"},ie={class:"mb-8"},ne={class:"mb-16"},de={class:"text-center"},re=["disabled"],ce={__name:"SettingView",setup(me){const N=T(),R=B(),S=E(),{openLoading:P,closeLoading:v}=R,{pushMessage:b}=S,{updateMyProfile:L}=N,U=c(null),{myProfile:x}=A(N),n=c("基本資料"),m=c({gender:"",nickName:"",description:""}),q=c(""),u=c({password:"",confirmPassword:""});h(x,a=>{m.value={nickName:a.nickName,gender:a.gender,description:a.description},q.value=a.avatarImgUrl},{immediate:!0,deep:!0});async function I(a){var e,o;P();try{const d=await z(a);L("update",d.data.data),b({style:"success",title:"更新成功",text:"更新成功"}),v()}catch(d){b({style:"danger",title:"更新失敗",text:((o=(e=d.response)==null?void 0:e.data)==null?void 0:o.message)||"更新失敗，請重整網頁"}),v()}}function M(a){I({avatarImgUrl:a})}async function $(){var a,e;P();try{await j(u.value),b({style:"success",title:"更新密碼成功",text:"更新密碼成功，未來請使用新密碼登入"}),U.value.resetForm(),v()}catch(o){b({style:"danger",title:"更新密碼失敗",text:((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"更新密碼失敗，請重新整理頁面"}),v()}}return(a,e)=>{const o=_("VField"),d=_("ErrorMessage"),C=_("VForm");return g(),f("div",G,[s("div",H,[e[10]||(e[10]=s("h5",{class:"sidebarTitle"},"帳號設定",-1)),s("ul",J,[s("li",null,[s("a",{href:"#",class:i(["sidebarLink",{active:n.value=="基本資料"}]),onClick:e[0]||(e[0]=y(t=>n.value="基本資料",["prevent"]))}," 基本資料 ",2)]),s("li",null,[s("a",{href:"#",class:i(["sidebarLink",{active:n.value=="個人頭像"}]),onClick:e[1]||(e[1]=y(t=>n.value="個人頭像",["prevent"]))}," 個人頭像 ",2)]),s("li",null,[s("a",{href:"#",class:i(["sidebarLink",{active:n.value=="更新密碼"}]),onClick:e[2]||(e[2]=y(t=>n.value="更新密碼",["prevent"]))}," 更新密碼 ",2)])])]),s("div",K,[n.value=="基本資料"?(g(),f("div",O,[l(C,{ref:"formRef",onSubmit:e[6]||(e[6]=t=>I(m.value))},{default:k(({errors:t,meta:p})=>[e[17]||(e[17]=s("h2",{class:"title mb-11"},[s("span",{class:"titleIcon bg-secondary-subtle"},[s("i",{class:"bi bi-people-fill"})]),s("span",null," 基本資料 ")],-1)),s("div",Q,[e[11]||(e[11]=s("label",{for:"id",class:"form-label"}," 會員編號： ",-1)),s("input",{type:"text",name:"id",id:"id",class:"form-control",value:F(x)._id,disabled:""},null,8,W)]),s("div",X,[e[12]||(e[12]=s("label",{for:"email",class:"form-label"}," 電子信箱： ",-1)),s("input",{type:"email",name:"email",id:"email",class:"form-control",value:F(x).email,disabled:""},null,8,Y)]),s("div",Z,[e[13]||(e[13]=s("label",{for:"nickName",class:"form-label"},[s("span",{class:"text-danger"},"*"),w(" 暱稱： ")],-1)),l(o,{type:"text",name:"暱稱",id:"nickName",class:i(["form-control",{"is-invalid":t.暱稱}]),placeholder:"請輸入暱稱",rules:"min:2|max:10|required",modelValue:m.value.nickName,"onUpdate:modelValue":e[3]||(e[3]=r=>m.value.nickName=r),required:""},null,8,["class","modelValue"]),l(d,{name:"暱稱",class:"invalid-feedback"})]),s("div",ee,[e[15]||(e[15]=s("label",{for:"gender",class:"form-label"},[s("span",{class:"text-danger"},"*"),w(" 性別： ")],-1)),l(o,{as:"select",name:"性別",id:"gender",class:i(["form-select",{"is-invalid":t.性別}]),placeholder:"請選擇性別",rules:"required",modelValue:m.value.gender,"onUpdate:modelValue":e[4]||(e[4]=r=>m.value.gender=r),required:""},{default:k(()=>e[14]||(e[14]=[s("option",{value:"secret",select:""},"秘密",-1),s("option",{value:"female"},"女生",-1),s("option",{value:"male"},"男生",-1)])),_:2},1032,["class","modelValue"]),l(d,{name:"性別",class:"invalid-feedback"})]),s("div",se,[e[16]||(e[16]=s("label",{for:"description",class:"form-label"}," 自我介紹： ",-1)),l(o,{as:"textarea",type:"text",rows:"3",placeholder:"請輸入自我介紹",class:i(["form-control",{"is-invalid":t.自我介紹}]),name:"自我介紹",rules:"max:100",modelValue:m.value.description,"onUpdate:modelValue":e[5]||(e[5]=r=>m.value.description=r)},null,8,["class","modelValue"]),l(d,{name:"自我介紹",class:"invalid-feedback"})]),s("div",le,[s("button",{type:"submit","aria-disabled":"true",class:i(["btn btn-primary w-75",{disabled:!p.valid}]),disabled:!p.valid}," 更新資料 ",10,ae)])]),_:1},512)])):V("",!0),n.value=="個人頭像"?(g(),f("div",te,[e[18]||(e[18]=s("h2",{class:"title mb-11"},[s("span",{class:"titleIcon bg-secondary-subtle"},[s("i",{class:"bi bi-people-fill"})]),s("span",null," 個人頭像 ")],-1)),l(D,{"temp-image-url":q.value,imageType:"avatar",onUpdateImage:M},null,8,["temp-image-url"])])):V("",!0),n.value=="更新密碼"?(g(),f("div",oe,[l(C,{ref_key:"passwordFormRef",ref:U,onSubmit:e[9]||(e[9]=t=>$(u.value))},{default:k(({errors:t,meta:p})=>[e[21]||(e[21]=s("h2",{class:"title mb-11"},[s("span",{class:"titleIcon bg-secondary-subtle"},[s("i",{class:"bi bi-people-fill"})]),s("span",null," 更新密碼 ")],-1)),s("div",ie,[e[19]||(e[19]=s("label",{for:"password",class:"form-label"},[s("span",{class:"text-danger"},"*"),w(" 新密碼： ")],-1)),l(o,{type:"password",name:"密碼",id:"password",class:i(["form-control",{"is-invalid":t.密碼}]),placeholder:"請輸入密碼",rules:"password:8|required",modelValue:u.value.password,"onUpdate:modelValue":e[7]||(e[7]=r=>u.value.password=r),required:""},null,8,["class","modelValue"]),l(d,{name:"密碼",class:"text-danger"})]),s("div",ne,[e[20]||(e[20]=s("label",{for:"confirmPassword",class:"form-label"},[s("span",{class:"text-danger"},"*"),w(" 請再次輸入一次新密碼： ")],-1)),l(o,{type:"password",name:"確認密碼",id:"confirmPassword",class:i(["form-control",{"is-invalid":t.確認密碼}]),placeholder:"請輸入確認密碼",rules:"confirmed:@密碼",modelValue:u.value.confirmPassword,"onUpdate:modelValue":e[8]||(e[8]=r=>u.value.confirmPassword=r),required:""},null,8,["class","modelValue"]),l(d,{name:"確認密碼",class:"text-danger"})]),s("div",de,[s("button",{type:"submit","aria-disabled":"true",class:i(["btn btn-primary w-75",{disabled:!p.valid}]),disabled:!p.valid}," 更新資料 ",10,re)])]),_:1},512)])):V("",!0)])])}}};export{ce as default};
