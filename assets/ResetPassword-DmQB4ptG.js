import{M as S,m as h,f as n,o as N,T as B,u as E,k as x,n as s,p as t,w as d,i as p,F as I,l as _,S as L,q as i,R as T,t as f,X as U}from"./index-aNaVcbTs.js";import{_ as j}from"./AlertModal-DeTNTfO6.js";const z={class:"d-flex flex-wrap justify-content-center aling-items-center my-17"},A={key:0,class:"mb-11 py-11 alert alert-danger"},D={class:"mb-8"},X={class:"mb-16"},$={class:"mb-11 text-center"},G=["disabled"],O={__name:"ResetPassword",setup(H){const V=B(),b=E(),k=S(),M=h(),{openLoading:R,closeLoading:g}=k,{pushMessage:F}=M,m=n(),w=n(),u=n(""),a=n({token:"",password:"",confirmPassword:""});async function P(){var o,e,l;R();try{await U(a.value),(o=m.value)==null||o.openModal(),g()}catch(r){F({style:"danger",title:"重設密碼失敗",text:"重設密碼失敗，請重新設定"}),u.value=((l=(e=r.response)==null?void 0:e.data)==null?void 0:l.message)||"重設密碼失敗，請重新設定",g()}}function q(){var o;w.value.resetForm(),(o=m.value)==null||o.hideModal(),b.push("/signIn")}return N(()=>{const{token:o}=V.query;o?a.value.token=o:b.push("/")}),(o,e)=>{const l=p("VField"),r=p("ErrorMessage"),C=p("VForm");return _(),x(I,null,[s("section",z,[t(C,{class:"accountForm bg-white rounded-3 shadow",onSubmit:P,ref_key:"formRef",ref:w},{default:d(({errors:v,meta:y})=>[e[5]||(e[5]=s("h1",{class:"mb-8 text-center h3"},"重設您的密碼",-1)),e[6]||(e[6]=s("p",{class:"mb-11 text-center text-muted lh-lg"},"請輸入您的新密碼",-1)),u.value?(_(),x("p",A,[e[2]||(e[2]=s("i",{class:"bi bi-exclamation-triangle-fill me-4"},null,-1)),i(" "+T(u.value),1)])):L("",!0),s("div",D,[e[3]||(e[3]=s("label",{for:"password",class:"d-block mb-4"},[s("span",{class:"text-danger"},"*"),i(" 新密碼： ")],-1)),t(l,{type:"password",name:"密碼",id:"password",class:f(["form-control",{"is-invalid":v.密碼}]),placeholder:"請輸入密碼",rules:"password:8|required",modelValue:a.value.password,"onUpdate:modelValue":e[0]||(e[0]=c=>a.value.password=c),required:""},null,8,["class","modelValue"]),t(r,{name:"密碼",class:"text-danger"})]),s("div",X,[e[4]||(e[4]=s("label",{for:"confirmPassword",class:"form-label"},[s("span",{class:"text-danger"},"*"),i(" 請再次輸入一次新密碼： ")],-1)),t(l,{type:"password",name:"確認密碼",id:"confirmPassword",class:f(["form-control",{"is-invalid":v.確認密碼}]),placeholder:"請輸入確認密碼",rules:"confirmed:@密碼",modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=c=>a.value.confirmPassword=c),required:""},null,8,["class","modelValue"]),t(r,{name:"確認密碼",class:"text-danger"})]),s("div",$,[s("button",{type:"submit","aria-disabled":"true",class:f(["w-75 btn btn-primary",{disabled:!y.valid}]),disabled:!y.valid}," 重設密碼 ",10,G)])]),_:1},512)]),t(j,{ref_key:"alertModalRef",ref:m},{"modal-header":d(()=>e[7]||(e[7]=[s("span",{class:"titleIcon bg-secondary text-white"},[s("i",{class:"bi bi-bell-fill"})],-1),i(" 密碼更新成功 ")])),"modal-content":d(()=>e[8]||(e[8]=[s("p",null,"密碼已成功更新",-1),s("p",null,"即將跳轉至登入頁面，請使用新密碼登入！",-1)])),"modal-footer":d(()=>[s("button",{type:"button",class:"w-50 btn btn-primary",onClick:q},"關閉")]),_:1},512)],64)}}};export{O as default};
